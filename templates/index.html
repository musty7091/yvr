{% extends "base.html" %}
{% block title %}Yönetim Paneli - YVR Reklam{% endblock %}

{% block content %}
<div class="mb-5">
    <h3 class="fw-bold mb-3 text-secondary">{{ ay_adi }} Ayı Genel Durum</h3>
    
    
    <div class="card card-custom p-4 mb-4 border-0 shadow-sm">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <span class="fw-bold small text-muted text-uppercase">Aylık Satış Hedefi</span>
                <div class="h4 mb-0 fw-bold">{{ "{:,.0f}".format(aylik_hedef) }} ₺</div>
            </div>
            <button class="btn btn-sm btn-outline-secondary rounded-pill px-3" data-bs-toggle="collapse" data-bs-target="#hedefForm">
                <i class="bi bi-pencil me-1"></i>Hedefi Değiştir
            </button>
        </div>

        <div class="collapse mb-3" id="hedefForm">
            <form action="{{ url_for('genel.hedef_guncelle') }}" method="POST" class="d-flex gap-2">
                <input type="number" name="yeni_hedef" class="form-control form-control-sm border-0 bg-light" placeholder="Yeni hedefi girin..." required>
                <button type="submit" class="btn btn-sm btn-primary px-3">Güncelle</button>
            </form>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-1">
            <span class="small text-muted">%{{ hedef_yuzde|int }} Tamamlandı</span>
            <span class="small fw-bold text-primary">{{ "{:,.0f}".format(is_hacmi) }} ₺</span>
        </div>
        <div class="progress" style="height: 12px; border-radius: 10px; background-color: #f0f0f0;">
            <div class="progress-bar bg-primary" role="progressbar" style="width: {{ hedef_yuzde }}%; transition: width 1s ease-in-out;"></div>
        </div>
    </div>

    {% if alarm_listesi %}
    <div class="alert alert-danger border-0 shadow-sm mb-4" style="border-radius: 20px; background-color: #fff5f5;">
        <h6 class="fw-bold text-danger mb-3"><i class="bi bi-exclamation-triangle-fill me-2"></i>DİKKAT: TESLİMATI BEKLEYEN İŞLER</h6>
        <div class="table-responsive">
            <table class="table table-sm table-borderless mb-0 small">
                <thead>
                    <tr class="text-muted border-bottom">
                        <th class="ps-0">Müşteri</th>
                        <th>İş Tanımı</th>
                        <th class="text-end">Tutar</th>
                    </tr>
                </thead>
                <tbody>
                    {% for is in alarm_listesi %}
                    <tr>
                        <td class="ps-0"><strong>{{ is.sahibi.ad_soyad }}</strong></td>
                        <td>{{ is.is_tanimi }}</td>
                        <td class="text-end text-danger fw-bold">{{ "{:,.2f}".format(is.toplam_bedel) }} {{ is.para_birimi }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <div class="row g-3">
        <div class="col-md-3 col-6">
            <div class="card card-custom p-4 border-0 h-100 shadow-sm text-center">
                <div class="text-uppercase small fw-bold text-muted mb-2">ALINAN İŞLER</div>
                <div class="h3 fw-bold text-primary mb-0">{{ "{:,.0f}".format(is_hacmi) }} ₺</div>
                <div class="small text-muted mt-1">Bu ayki toplam ciro</div>
            </div>
        </div>
        
        <div class="col-md-3 col-6">
            <div class="card card-custom p-4 border-0 h-100 shadow-sm text-center">
                <div class="text-uppercase small fw-bold text-muted mb-2">HAMMADDE ALIMI</div>
                <div class="h3 fw-bold text-danger mb-0">{{ "{:,.0f}".format(ticari_alim) }} ₺</div>
                <div class="small text-muted mt-1">Bu ayki malzeme borcu</div>
            </div>
        </div>

        <div class="col-md-3 col-6">
            <div class="card card-custom p-4 border-0 h-100 shadow-sm text-center">
                <div class="text-uppercase small fw-bold text-muted mb-2">GİDERLER</div>
                <div class="h3 fw-bold text-warning mb-0">{{ "{:,.0f}".format(giderler) }} ₺</div>
                <div class="small text-muted mt-1">Kira, maaş, fatura vb.</div>
            </div>
        </div>

        <div class="col-md-3 col-6">
            <div class="card card-custom p-4 border-0 h-100 shadow-sm text-center" style="background-color: #f1f8e9;">
                <div class="text-uppercase small fw-bold text-success mb-2">TAHMİNİ KÂR</div>
                <div class="h3 fw-bold text-success mb-0">{{ "{:,.0f}".format(kar) }} ₺</div>
                <div class="small text-success mt-1">İşler - (Alım + Gider)</div>
            </div>
        </div>
    </div>
</div>

<hr class="my-5 opacity-25">

<div class="row g-4 justify-content-center">
    <div class="col-md-4">
        <a href="{{ url_for('musteri.satislar') }}" class="text-decoration-none">
            <div class="card card-custom h-100 border-0 shadow-lg card-hover-effect text-center p-5" style="transition: transform 0.2s;">
                <div class="mb-3">
                    <i class="bi bi-people-fill display-1 text-primary"></i>
                </div>
                <h2 class="fw-bold text-dark">SATIŞLAR</h2>
                <p class="text-muted">Müşteriler, Sipariş Takibi ve Tahsilat Yönetimi</p>
            </div>
        </a>
    </div>

    <div class="col-md-4">
        <a href="{{ url_for('tedarikci.ticari_borclar') }}" class="text-decoration-none">
            <div class="card card-custom h-100 border-0 shadow-lg card-hover-effect text-center p-5" style="transition: transform 0.2s;">
                <div class="mb-3">
                    <i class="bi bi-boxes display-1 text-danger"></i>
                </div>
                <h2 class="fw-bold text-dark">TİCARİ BORÇLAR</h2>
                <p class="text-muted">Tedarikçi Yönetimi ve Hammadde Alımları</p>
            </div>
        </a>
    </div>

    <div class="col-md-4">
        <a href="{{ url_for('gider.giderler') }}" class="text-decoration-none">
            <div class="card card-custom h-100 border-0 shadow-lg card-hover-effect text-center p-5" style="transition: transform 0.2s;">
                <div class="mb-3">
                    <i class="bi bi-wallet2 display-1 text-warning"></i>
                </div>
                <h2 class="fw-bold text-dark">GİDERLER</h2>
                <p class="text-muted">Kira, Personel, Fatura ve Diğer İşletme Giderleri</p>
            </div>
        </a>
    </div>
</div>

<style>
    .card-hover-effect:hover {
        transform: translateY(-10px);
        background-color: #f8f9fa;
    }
</style>
{% endblock %}